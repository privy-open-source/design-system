import{_ as X,o as u,c as C,j as p,d as es,a6 as as,p as w,h as O,v as ts,$ as is,an as ns,k as t,e as B,G as r,w as c,t as Q,T as ls,b as $,r as rs,n as os,V as ds,ak as f,a as D,B as ps,al as G}from"./chunks/framework.CI6Dj8yt.js";import{_ as U}from"./chunks/Button.vue_vue_type_script_setup_true_lang.DOHgQt4I.js";/* empty css                                                      */import{u as hs}from"./chunks/index.CM3hlGhp.js";import{f as Y}from"./chunks/base64.CRVHLH2y.js";import{u as cs,a as ks,b as us}from"./chunks/index.CcwQOeXo.js";import{a as J}from"./chunks/index.CTKDZ3kg.js";import{d as Es}from"./chunks/defu.BhsQtd2f.js";import{v as gs}from"./chunks/index.F8WrAqlk.js";import{u as ms}from"./chunks/index.CQImwLBD.js";import{_ as ys}from"./chunks/Banner.vue_vue_type_script_setup_true_lang.CaxF_UPh.js";/* empty css                                                      */import"./chunks/index.DvWHfs5K.js";import"./chunks/SpinnerRinggo.vue_vue_type_script_setup_true_lang.CAbNIu6d.js";import"./chunks/use-singleton.P5iNpjxE.js";import"./chunks/queue.DLTVddtq.js";import"./chunks/Input.vue_vue_type_script_setup_true_lang.DZPhP39w.js";import"./chunks/20.CQtyJIeF.js";import"./chunks/accept.6g-OpsWF.js";/* empty css                                                     */import"./chunks/FormGroup.vue_vue_type_script_setup_true_lang.PhsqGXKW.js";import"./chunks/20.BXrzkPip.js";import"./chunks/Caption.vue_vue_type_script_setup_true_lang.Th4M_igz.js";/* empty css                                                       */import"./chunks/index.DaIlsiXv.js";import"./chunks/purify.es.B6CWwVBg.js";import"./chunks/index.B8Koy_FO.js";/* empty css                                                         */import"./chunks/20.BYyB1xUG.js";import"./chunks/16.D7uNs2_7.js";const vs={},_s={xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"none",class:"persona-icon",viewBox:"0 0 16 16"};function fs(a,e){return u(),C("svg",_s,e[0]||(e[0]=[p("path",{fill:"currentColor","fill-rule":"evenodd",d:"M5.978 2.351A6 6 0 0 1 14 8a.5.5 0 0 1-1 0 5 5 0 0 0-8.515-3.556H5.86a.5.5 0 1 1 0 1h-2.4a.5.5 0 0 1-.545-.5V2.5a.5.5 0 1 1 1 0v1.104A6 6 0 0 1 5.979 2.35M2.5 7.5A.5.5 0 0 1 3 8a5 5 0 0 0 8.515 3.556H10.14a.5.5 0 1 1 0-1h2.4a.5.5 0 0 1 .545.5V13.5a.5.5 0 1 1-1 0v-1.104a6 6 0 0 1-8.903-.821A6 6 0 0 1 2 8a.5.5 0 0 1 .5-.5","clip-rule":"evenodd"},null,-1)]))}const bs=X(vs,[["render",fs]]),As={},Cs={xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",fill:"none",class:"persona-icon",viewBox:"0 0 24 24"};function xs(a,e){return u(),C("svg",Cs,e[0]||(e[0]=[p("path",{fill:"currentColor","fill-rule":"evenodd",d:"M9.104 4.746A2.58 2.58 0 0 1 10.92 4h2.16c.68 0 1.333.268 1.816.746l1.995 1.973h.609a3.5 3.5 0 0 1 3.5 3.5v6.28a3.5 3.5 0 0 1-3.5 3.5h-11A3.5 3.5 0 0 1 3 16.5v-6.28a3.5 3.5 0 0 1 3.5-3.5h.609zm1.816.754c-.285 0-.559.112-.762.313L7.944 8.002a.75.75 0 0 1-.527.217H6.5a2 2 0 0 0-2 2v6.28a2 2 0 0 0 2 2h11a2 2 0 0 0 2-2v-6.28a2 2 0 0 0-2-2h-.917a.75.75 0 0 1-.527-.217l-2.214-2.19a1.08 1.08 0 0 0-.762-.312zM8.5 12.917a3.5 3.5 0 1 1 7 0 3.5 3.5 0 0 1-7 0m3.5-2a2 2 0 1 0 0 4 2 2 0 0 0 0-4","clip-rule":"evenodd"},null,-1)]))}const K=X(As,[["render",xs]]),ws={},Ts={xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",fill:"none",class:"persona-icon",viewBox:"0 0 24 24"};function Ps(a,e){return u(),C("svg",Ts,e[0]||(e[0]=[p("path",{fill:"currentColor","fill-rule":"evenodd",d:"M14.946 5.103a7.5 7.5 0 0 0-8.22 1.564h1.607a.75.75 0 0 1 0 1.5H4.667a.75.75 0 0 1-.75-.75V3.75a.75.75 0 1 1 1.5 0v2.113A8.999 8.999 0 1 1 3 11.901a.75.75 0 0 1 1.5.017 7.5 7.5 0 1 0 10.445-6.815","clip-rule":"evenodd"},null,-1)]))}const Fs=X(ws,[["render",Ps]]),Ss="/design-system/assets/shutter.dnWqXwNU.wav";function H(a,e=!1){const i=document.createElement("canvas"),n=i.getContext("2d");return i.width=a.videoWidth,i.height=a.videoHeight,e?(n.save(),n.scale(-1,1),n.drawImage(a,0,0,i.width*-1,i.height),n.restore()):n.drawImage(a,0,0,i.width,i.height),i.toDataURL("image/jpeg")}const Ds={meta:{facingMode:"environment"},run({video:a,meta:e,modifier:i}){const n=!!(e.value.mirror&&e.value.mirror!=="preview"),s=H(a.value,n),o=i.value.base64?s:Y(s);return{preview:s,result:o}}},qs=["data-deviceid"],Is=[".srcObject"],Bs=["src"],Vs={key:2,"data-testid":"camera-off",class:"camera__off-info"},Ms={class:"camera__mask-container"},Rs={key:0,"data-testid":"camera-mask",class:"camera__mask"},Ns={"data-testid":"camera-toast",class:"camera__toast-text"},Os={class:"camera__controls"},$s=["src","muted"],b=es({__name:"Camera",props:{modelValue:{type:[globalThis.File,String,Array],default:""},modelModifiers:{type:Object,default:()=>({})},mirror:{type:[Boolean,String],default:void 0},mask:{type:String,default:void 0},adapter:{type:Object,default:Ds},facingMode:{type:String,default:void 0},silent:{type:Boolean,default:!1}},emits:["update:modelValue","result","change","start"],setup(a,{expose:e,emit:i}){const n=a,s=i,o=hs(n),h=as(n,"modelModifiers"),E=w(!1),l=w(!1),m=w(""),A=w(""),g=w(),k=w(),v=cs("camera",{controls:!0}),S=w(0),_=O(()=>Es({mirror:n.mirror,mask:n.mask,facingMode:n.facingMode},n.adapter.meta,{autoStart:!1})),{videoInputs:x}=ks({requestPermissions:!1,constraints:{video:{facingMode:_.value.facingMode}}}),q=O(()=>{var d,y;return(y=(d=x.value)==null?void 0:d.at(S.value))==null?void 0:y.deviceId}),V=O(()=>({video:{deviceId:q.value},audio:!1})),{stream:T,start:M,stop:R,enabled:P}=us({constraints:V}),N=O(()=>{const d=[];return _.value.mirror&&d.push("camera--mirror"),_.value.mask?d.push(`camera__mask--${_.value.mask}`):d.push("camera__mask--none"),d});async function I(){var d;v.state.value==="denied"&&await J({title:"Camera Access Blocked",text:"Privy need to access your internal camera to process this journey",confirm:{text:"Ok"},footerAlign:"end"}),v.state.value==="prompt"&&await J({title:"Camera Access Required",text:"Privy need to access your internal camera to process this journey",confirm:{text:"Ok"},footerAlign:"end"}),await M(),typeof((d=k.value)==null?void 0:d.play)=="function"&&await k.value.play()}function z(){S.value=(S.value+1)%x.value.length}function L(d){A.value=d}async function j(){var y;E.value=!0;const d=await n.adapter.run({video:k,toast:L,stream:T,meta:_,modifier:h});m.value=d.preview,o.value=d.result,l.value=!0,E.value=!1,P.value=!1,s("result",d.result),s("change",d.result),typeof((y=g.value)==null?void 0:y.play)=="function"&&g.value.play()}async function W(){P.value=!0,l.value=!1,m.value="",A.value=""}function ss(){s("start",T.value),_.value.autoStart&&j()}return ts(async()=>{v.isSupported&&(await ms(v.state).not.toBeUndefined(),await I())}),is(()=>{R()}),e({take:j,retake:W,toast:L,toggle:z}),(d,y)=>ns((u(),C("div",{class:os(["camera",t(N)]),"data-testid":"camera","data-deviceid":t(q)},[t(T)?(u(),C("video",{key:0,ref_key:"video",ref:k,"data-testid":"camera-video",".srcObject":t(T),class:"camera__video",autoplay:"",muted:"",playsinline:"",onPlay:ss},null,40,Is)):B("",!0),t(l)&&!t(T)?(u(),C("img",{key:1,"data-testid":"camera-result",class:"camera__result",src:t(m),alt:"camera-result"},null,8,Bs)):B("",!0),!t(P)&&!t(l)?(u(),C("span",Vs," Camera is off ")):B("",!0),p("div",Ms,[t(l)?B("",!0):(u(),C("div",Rs))]),r(ls,{name:"slide-up"},{default:c(()=>[t(A)?(u(),C("div",{key:t(A),class:"camera__toast"},[p("div",Ns,Q(t(A)),1)])):B("",!0)]),_:1}),p("div",Os,[t(x).length>1&&!t(l)?(u(),$(U,{key:0,"data-testid":"camera-toggle",color:"danger",size:"sm",icon:"",pill:"",onClick:z},{default:c(()=>[r(bs)]),_:1})):B("",!0),!t(P)&&!t(l)?(u(),$(U,{key:1,"data-testid":"camera-turn-on",class:"camera__main-control",color:"danger",icon:"",pill:"",onClick:y[0]||(y[0]=Z=>I())},{default:c(()=>[r(K)]),_:1})):t(P)&&!t(l)?(u(),$(U,{key:2,"data-testid":"camera-take",class:"camera__main-control",color:"danger",icon:"",pill:"",disabled:t(E),onClick:y[1]||(y[1]=Z=>j())},{default:c(()=>[r(K)]),_:1},8,["disabled"])):(u(),$(U,{key:3,"data-testid":"camera-retake",class:"camera__main-control",color:"danger",icon:"",pill:"",onClick:y[2]||(y[2]=Z=>W())},{default:c(()=>[r(Fs)]),_:1}))]),p("audio",{ref_key:"shutter",ref:g,src:t(Ss),muted:a.silent},null,8,$s),rs(d.$slots,"default",{cameras:t(x),preview:t(m),stream:t(T),video:t(k),shutter:t(g),toast:L})],10,qs)),[[t(gs),4/3,void 0,{fixed:!0}]])}}),Us=40,Hs=15,F=160;function Ls(a,e){const i=a.getContext("2d",{willReadFrequently:!0});return i.drawImage(e,e.videoWidth/2-F,e.videoHeight/2-F,F,F,0,0,F,F),i.getImageData(0,0,a.width,a.height)}function js(a){const e=a.width/2,i=a.height/2,n=a.width/4,s=a.height/4,o=e-n/2,h=i-s/2,E=new Uint8ClampedArray(n*s),l={centerX:e,centerY:i,width:n,height:s,xPos:o,yPos:h,buffer:E},m=a.data;let A=0;for(let g=l.yPos;g<l.yPos+l.height;g++){let k=g*a.width*4+l.xPos*4+1;for(let v=l.xPos;v<l.xPos+l.width;v++)l.buffer[A++]=m[k],k+=4}return l}function Qs(a,e){let i=0,n=0,s=0;const o=a.width/4,h=a.height/4,E=a.data;for(let _=e.centerY-h;_<=e.centerY+h-e.height;_++)for(let x=e.centerX-o;x<=e.centerX+o-e.width;x++){let q=0,V=0,T=0;for(let R=0;R<e.height;R++){let P=x*4+1+(_+R)*a.width*4;for(let N=0;N<e.width;N++){const I=E[P];q+=e.buffer[T++]*I,V+=I*I,P+=4}}let M=0;V>0&&(M=q*q/V),M>s&&(s=M,i=x,n=_)}const l=i-e.xPos,m=n-e.yPos,A=Math.hypot(l,m),g=o-e.width/2,k=h-e.height/2,v=Math.hypot(g,k);let S=A/v*100;return S>100&&(S=100),S}const Ys={meta:{mask:"round",mirror:!0,facingMode:"user"},async run({video:a,toast:e,meta:i,modifier:n}){return await new Promise(s=>{const o=!!(i.value.mirror&&i.value.mirror!=="preview"),h=H(a.value,o),E=document.createElement("canvas");E.width=F,E.height=F;let l;const m=setInterval(function(){if(a.value){const g=Ls(E,a.value);if(!l)l=js(g);else if(Qs(g,l)>Us){const k=H(a.value,o),v=n.value.base64?[k,h]:[Y(k),Y(h)];clearInterval(m),e(""),s({preview:k,result:v})}}},1e3/Hs);e("Move your head slowly. Your photo will be taken automatically")})}},Xs={meta:{mask:"square",facingMode:"environment",autoStart:!0},async run({video:a,toast:e,meta:i}){const n=!!(i.value.mirror&&i.value.mirror!=="preview"),{BrowserQRCodeReader:s}=await ds(async()=>{const{BrowserQRCodeReader:m}=await import("./chunks/index.CGLf5YIS.js");return{BrowserQRCodeReader:m}},[]),h=await new s().decodeOnceFromVideoElement(a.value),E=H(a.value,n),l=h.getText();return e(l),{preview:E,result:l}}},zs={class:"truncate"},Ws={class:"truncate"},Te=JSON.parse(`{"title":"Camera · Components","description":"Take picture from user's camera","frontmatter":{"title":"Camera · Components","description":"Take picture from user's camera"},"headers":[],"relativePath":"components/camera/index.md","filePath":"components/camera/index.md"}`),Zs={name:"components/camera/index.md"},Pe=Object.assign(Zs,{setup(a){const e=w(),i=w();return(n,s)=>{const o=ps("preview");return u(),C("div",null,[s[3]||(s[3]=f("",4)),r(o,{class:"flex-col"},{default:c(()=>[r(b)]),_:1}),s[4]||(s[4]=f("",3)),r(o,{class:"flex-col"},{default:c(()=>[r(b,{mirror:""})]),_:1}),s[5]||(s[5]=f("",3)),r(o,{class:"flex-col"},{default:c(()=>[r(b,{mirror:"preview"})]),_:1}),s[6]||(s[6]=f("",3)),r(o,{class:"flex-col space-y-2"},{default:c(()=>[r(b,{mask:"square"}),r(b,{mask:"round"}),r(b,{mask:"card"})]),_:1}),s[7]||(s[7]=f("",3)),r(o,{class:"flex-col"},{default:c(()=>[r(b,{silent:""})]),_:1}),s[8]||(s[8]=f("",3)),r(o,{class:"flex-col space-y-2"},{default:c(()=>[r(b,{adapter:t(Ys)},null,8,["adapter"])]),_:1}),s[9]||(s[9]=f("",3)),r(o,{class:"flex-col space-y-2"},{default:c(()=>[r(b,{adapter:t(Xs)},null,8,["adapter"])]),_:1}),s[10]||(s[10]=f("",3)),r(o,{class:"flex-col"},{default:c(()=>[r(b,{modelValue:t(e),"onUpdate:modelValue":s[0]||(s[0]=h=>G(e)?e.value=h:null)},null,8,["modelValue"])]),_:1}),s[11]||(s[11]=f("",2)),p("pre",zs,[p("code",null,Q(t(e)),1)]),s[12]||(s[12]=p("h3",{id:"encode-to-base64",tabindex:"-1"},[D("Encode to base64 "),p("a",{class:"header-anchor",href:"#encode-to-base64","aria-label":'Permalink to "Encode to base64"'},"​")],-1)),s[13]||(s[13]=p("p",null,[D("You can add modifier "),p("code",null,"base64"),D(" to your "),p("code",null,"v-model"),D(", it's enforce result to "),p("a",{href:"https://en.wikipedia.org/wiki/Data_URI_scheme",target:"_blank",rel:"noreferrer"},"base64-dataURI"),D(".")],-1)),r(ys,{dismissable:!1},{default:c(()=>s[2]||(s[2]=[p("b",null,"Note!",-1),D(),p("code",null,"v-model.base64",-1),D(" on QRCodeAdapter has no effect, the result will always original scanned text. ")])),_:1}),r(o,{class:"flex-col"},{default:c(()=>[r(b,{modelValue:t(i),"onUpdate:modelValue":s[1]||(s[1]=h=>G(i)?i.value=h:null),modelModifiers:{base64:!0}},null,8,["modelValue"])]),_:1}),s[14]||(s[14]=f("",2)),p("pre",Ws,[p("code",null,Q(t(i)),1)]),s[15]||(s[15]=f("",7))])}}});export{Te as __pageData,Pe as default};
