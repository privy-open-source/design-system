const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/chunks/interact.min.BKitjnf_.js","assets/chunks/commonjsHelpers.BosuxZz1.js"])))=>i.map(i=>d[i]);
import{D as j,L as J,q as O,ay as q,V as U,k as v,d as ne,p as E,s as ie,a6 as L,v as oe,X as le,o as k,c as se,j as A,r as ue,b as re,e as ce,an as de,ao as fe,Y as P,a0 as R}from"./framework.CI6Dj8yt.js";import{a as ve}from"./floating-ui.dom.D8eMPWlJ.js";import{i as T}from"./index.CcwQOeXo.js";import{D as me}from"./PdfViewer.vue_vue_type_style_index_0_lang.CS_a12wZ.js";import{u as pe,a as he,f as ge,P as ye,b as be}from"./use-idle.DNpLroyr.js";import{c as z}from"./use-focus.3sjawyk-.js";import{g as xe,_ as we}from"./PdfObjectDebugger.vue_vue_type_style_index_0_lang.Cds1uYRZ.js";import{s as N,u as Ne}from"./index.CQImwLBD.js";function _e(r,t){const e=j(!0),a=j(),{hoverzone:n}=J(me);async function d(){if(f(),r.value){const{default:c}=await U(async()=>{const{default:h}=await import("./interact.min.BKitjnf_.js").then(m=>m.i);return{default:h}},__vite__mapDeps([0,1]));a.value=c(r.value).draggable({inertia:!0,enabled:e.value,autoScroll:{container:r.value.parentElement,margin:100,speed:300},onstart:t.onstart,onmove:t.onmove,onend:t.onend,modifiers:[c.modifiers.restrict({restriction:"parent",elementRect:{top:0,left:0,bottom:1,right:1}}),c.modifiers.restrictRect({endOnly:!0,restriction:()=>n.value?c.getElementRect(n.value):{top:0,left:0,bottom:Number.POSITIVE_INFINITY,right:Number.POSITIVE_INFINITY}})]}).on("tap",t.ontap)}}function f(){a.value&&a.value.unset()}return O(r,async()=>{await d()}),O(e,c=>{a.value&&a.value.draggable(c)}),q(()=>{f()}),e}function Ie(r,t={}){const e=j(!0),a=j();async function n(){var f,c,h;if(d(),r.value){const{default:m}=await U(async()=>{const{default:g}=await import("./interact.min.BKitjnf_.js").then(w=>w.i);return{default:g}},__vite__mapDeps([0,1]));a.value=m(r.value).resizable({enabled:e.value,edges:{left:!1,top:!1,bottom:(f=t.handleSelector)!=null?f:".resize-handle",right:(c=t.handleSelector)!=null?c:".resize-handle"},onstart:t.onstart,onmove:t.onmove,onend:t.onend,modifiers:[m.modifiers.aspectRatio({ratio:(h=v(t.ratio))!=null?h:"preserve",modifiers:[m.modifiers.restrictSize({min:(g,w,l)=>{var u;const o=(u=v(t.scale))!=null?u:1;return{...l.rect,width:v(t.minWidth)*o,height:v(t.minHeight)*o}},max:(g,w,l)=>{var u;const o=(u=v(t.scale))!=null?u:1;return{...l.rect,width:v(t.maxWidth)*o,height:v(t.maxHeight)*o}}}),m.modifiers.restrictSize({max:(g,w,l)=>{const o=v(t.reference);if(o){const u=m.getElementRect(o);if(u){const y=u.right-l.rect.left,b=u.bottom-l.rect.top;return{...u,width:y,height:b}}}return{...l.rect,width:Number.POSITIVE_INFINITY,height:Number.POSITIVE_INFINITY}}})]})]})}}function d(){a.value&&a.value.unset()}return O(r,async()=>{await n()}),O(e,f=>{a.value&&a.value.draggable(f)},{immediate:!0}),q(()=>{d()}),e}function Ee(r,t=document.body){let e=r.parentElement;do{const{position:a}=window.getComputedStyle(e);if(a==="relative"||a==="absolute")return e;e=e.parentElement}while(e&&e!==t);return t}function Te(r){const{container:t,reference:e,x:a,y:n,scale:d}=r,f=e.getBoundingClientRect(),c=Ee(e,t),h=c.getBoundingClientRect(),m=f.top-h.top+c.scrollTop,g=f.left-h.left+c.scrollLeft;return{top:m+n*d,left:g+a*d}}function Be(r){const{reference:t,object:e,scale:a}=r,n=e.getBoundingClientRect(),d=t.getBoundingClientRect(),f=Math.floor((d.width-n.width)/a),c=Math.floor((d.height-n.height)/a),h=(n.left-d.left)/a,m=(n.top-d.top)/a,g=Number.parseInt(t.dataset.pageNumber);return{x:z(h,1,f-1),y:z(m,1,c-1),page:g}}const Pe=["data-x","data-y","data-page","data-width","data-height"],Re={class:"pdf-object__container"},je={class:"pdf-object__resize resize-handle"},Ye=ne({__name:"PdfObject",props:{x:{type:Number,default:void 0},y:{type:Number,default:void 0},page:{type:Number,default:void 0},width:{type:Number,default:198},height:{type:Number,default:106},minWidth:{type:Number,default:void 0},minHeight:{type:Number,default:void 0},maxWidth:{type:Number,default:void 0},maxHeight:{type:Number,default:void 0},moveable:{type:Boolean,default:!0},resizable:{type:Boolean,default:!0},autofocus:{type:Boolean,default:!1},debug:{type:Boolean,default:!1}},emits:["update:x","update:y","update:page","update:width","update:height"],setup(r){const t=r,e=E(),{root:a,scale:n,objects:d}=J(ye),f=T(t,"x"),c=T(t,"y"),h=T(t,"page"),m=T(t,"width"),g=T(t,"height"),{id:w,x:l,y:o,page:u,width:y,height:b,minHeight:C,minWidth:D,maxHeight:F,maxWidth:H,ratio:W}=pe(t),S=E(!1),Y=E(),M=E(),V=E(),x=he(u),Z=_e(e,{onstart(){const{left:i,top:s}=e.value.getBoundingClientRect();S.value=!0,Y.value=l.value,M.value=o.value,V.value=u.value,l.value=i,o.value=s},onmove(i){l.value+=i.dx,o.value+=i.dy},onend(i){if(i.relatedTarget){const s=Be({reference:i.relatedTarget,container:a.value,object:e.value,scale:n.value});l.value=s.x,o.value=s.y,u.value=s.page}else l.value=Y.value,o.value=M.value,u.value=V.value;S.value=!1}}),$=Ie(e,{minHeight:C,minWidth:D,maxHeight:F,maxWidth:H,scale:n,ratio:W,reference:x,onmove(i){i.rect&&n.value&&(y.value=i.rect.width/n.value,b.value=i.rect.height/n.value)}});ie(i=>{if(e.value)if(x.value&&a.value)if(e.value.style.display="block",e.value.style.width=`${y.value}px`,e.value.style.height=`${b.value}px`,S.value)e.value.style.position="fixed",e.value.style.transform=`translate(${l.value}px, ${o.value}px) scale(${n.value})`,e.value.style.zIndex="50";else{const s=ve(x.value,e.value,()=>{const{left:p,top:_}=Te({reference:x.value,container:a.value,x:l.value,y:o.value,scale:n.value});e.value.style.position="absolute",e.value.style.transform=`translate(${p}px, ${_}px) scale(${n.value})`,e.value.style.zIndex="10"},{ancestorScroll:!1,animationFrame:!0});i(s)}else e.value.style.display="none"});function B(i,s,p){if(t.moveable){const _=x.value.clientWidth,I=x.value.clientHeight,X=Math.floor(_/n.value-y.value),K=Math.floor(I/n.value-b.value),Q=i.metaKey||i.ctrlKey?X:i.shiftKey?10:1,ee=i.metaKey||i.ctrlKey?K:i.shiftKey?10:1,te=l.value+s*Q,ae=o.value+p*ee;l.value=z(te,0,X),o.value=z(ae,0,K)}}function G(){const i=[...d.values()].filter(I=>I.id!==w&&Number.isFinite(I.x)&&Number.isFinite(I.y)&&I.page===u.value),s={width:y.value,height:b.value},p={width:x.value.clientWidth/n.value,height:x.value.clientHeight/n.value},_=xe({size:s,offside:p,objects:i});l.value=_.x,o.value=_.y}return N(l,f),N(o,c),N(u,h),N(y,m),N(b,g),N(Z,L(t,"moveable"),{direction:"rtl",immediate:!0}),N($,L(t,"resizable"),{direction:"rtl",immediate:!0}),oe(async()=>{await Ne(x).toBeTruthy(),(!Number.isFinite(l.value)||!Number.isFinite(o.value))&&G(),t.autofocus&&ge(e.value)}),le(be,{id:w,x:l,y:o,page:u,width:y,height:b,minHeight:C,minWidth:D,maxHeight:F,maxWidth:H,ratio:W}),(i,s)=>(k(),se("div",{ref_key:"object",ref:e,"data-testid":"pdf-object",class:"pdf-object",tabindex:"0","data-x":v(l),"data-y":v(o),"data-page":v(u),"data-width":v(y),"data-height":v(b),onKeydown:[s[0]||(s[0]=P(R(p=>B(p,0,-1),["stop","prevent"]),["up"])),s[1]||(s[1]=P(R(p=>B(p,0,1),["stop","prevent"]),["down"])),s[2]||(s[2]=P(R(p=>B(p,-1,0),["stop","prevent"]),["left"])),s[3]||(s[3]=P(R(p=>B(p,1,0),["stop","prevent"]),["right"]))]},[A("div",Re,[ue(i.$slots,"default"),r.debug?(k(),re(we,{key:0})):ce("",!0)]),de(A("div",je,null,512),[[fe,v($)]])],40,Pe))}});export{Ye as _,Be as g};
