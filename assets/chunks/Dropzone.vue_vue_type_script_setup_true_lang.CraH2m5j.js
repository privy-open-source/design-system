import{d as D,p as v,aF as M,a6 as $,h as S,c as k,j as N,K as x,r as V,k as f,n as F,a0 as y,o as O,P}from"./framework.CI6Dj8yt.js";import{u as j}from"./index.wZ2oc0_6.js";import{t as A}from"./base64.CRVHLH2y.js";function H(l,p){return l?p.filter(c=>{const t=String(c.name).toLowerCase(),i=String(c.type).toLowerCase();return l.split(",").some(u=>{const n=u.trim().toLowerCase();return n.charAt(0)==="."?t.endsWith(n):n.endsWith("/*")?i.replace(/\/.*$/,"")===n.replace(/\/.*$/,""):i===n})}):p}const I=["multiple","accept","disabled"],K=D({__name:"Dropzone",props:{modelValue:{type:[globalThis.File,Array,String],default:void 0},modelModifiers:{type:Object,default:()=>({})},multiple:{type:[Boolean,String],default:!1},maxlength:{type:[Number,String],default:void 0},accept:{type:String,default:""},clearOnCancel:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},readonly:{type:Boolean,default:!1}},emits:["update:modelValue","change","cancel"],setup(l,{expose:p,emit:c}){const t=l,i=c,s=j(t),u=v(),n=v(),b=M($(t,"maxlength"),{method:"parseInt"}),d=v(!1),m=v(!1),B=S(()=>{const a=[];return d.value&&a.push("dropzone--dragover"),m.value&&a.push("dropzone--hover"),t.disabled&&a.push("dropzone--disabled"),t.readonly&&a.push("dropzone--readonly"),a});function h(){n.value.value="",n.value.click()}function g(){n.value.value="",u.value=void 0,s.value=void 0}function T(a){if(!t.disabled&&!t.readonly){const e=a.dataTransfer.files;d.value=!1,z(e)}}function w(a){const e=a.target,o=e.files;z(o),t.multiple==="append"&&P(()=>{e.value=""})}function C(a){return Array.isArray(a)?Promise.all(a.map(e=>A(e))):A(a)}async function z(a){if(a.length>0){const e=H(t.accept,Array.from(a)),o=t.multiple===!1?e.at(0):e;let r=o;t.multiple==="append"&&Array.isArray(s.value)&&(r=[...s.value,...r]),Number.isInteger(b.value)&&Array.isArray(r)&&(r=r.slice(0,b.value)),u.value=r,t.modelModifiers.base64&&(r=await C(o)),s.value=r,i("change",r)}else t.clearOnCancel&&g(),i("cancel")}return p({browse:h,clear:g,input:n}),(a,e)=>(O(),k("label",{class:F(["dropzone",f(B)]),"data-testid":"dropzone",onDrop:y(T,["prevent"]),onDragover:e[0]||(e[0]=y(()=>{},["prevent"])),onDragenter:e[1]||(e[1]=y(o=>d.value=!0,["prevent"])),onDragleave:e[2]||(e[2]=y(o=>d.value=!1,["prevent"])),onMouseover:e[3]||(e[3]=o=>m.value=!0),onMouseout:e[4]||(e[4]=o=>m.value=!1)},[N("input",x({ref_key:"input",ref:n,"data-testid":"dropzone-input",class:"dropzone__input",type:"file",multiple:l.multiple!==!1,accept:l.accept,disabled:l.disabled||l.readonly},a.$attrs,{onChange:w}),null,16,I),V(a.$slots,"default",{isDragover:f(d),isHovered:f(m),disabled:l.disabled,readonly:l.readonly,model:f(s),rawModel:f(u),browse:h,clear:g})],34))}});export{K as _};
